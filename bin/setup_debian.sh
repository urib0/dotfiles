#!/bin/bash

# ログ出力の設定
LOG_OUT=./$(date +"log_%Y%m%d_%H%M%S%m.txt")

exec 1> >(tee -a $LOG_OUT)
exec 2>>$LOG_OUT
# 将来的にログだけタイムスタンプつけるようにしたい
#exec 1> >(
#  while read -r l; do echo "[$(date +"%Y-%m-%d %H:%M:%S")] $l"; done \
#    | tee -a $LOG_OUT
#)

sudo printf ''

echo ""
echo ""
echo ""
echo "//////////////////////////////////////////////////////////////////////////////////////////////////////////"
echo "//////////////////////////////////////////////////////////////////////////////////////////////////////////"
echo "STATE_1 install packages"
echo "//////////////////////////////////////////////////////////////////////////////////////////////////////////"
echo "//////////////////////////////////////////////////////////////////////////////////////////////////////////"
./step_apt.sh

echo ""
echo ""
echo ""
echo "//////////////////////////////////////////////////////////////////////////////////////////////////////////"
echo "//////////////////////////////////////////////////////////////////////////////////////////////////////////"
echo "STATE_2 create symbolic links"
echo "//////////////////////////////////////////////////////////////////////////////////////////////////////////"
echo "//////////////////////////////////////////////////////////////////////////////////////////////////////////"
./step_symlink.sh

echo ""
echo ""
echo ""
echo "//////////////////////////////////////////////////////////////////////////////////////////////////////////"
echo "//////////////////////////////////////////////////////////////////////////////////////////////////////////"
echo "STATE_3 install pyenv"
echo "//////////////////////////////////////////////////////////////////////////////////////////////////////////"
echo "//////////////////////////////////////////////////////////////////////////////////////////////////////////"
./step_pyenv.sh

echo ""
echo ""
echo ""
echo "//////////////////////////////////////////////////////////////////////////////////////////////////////////"
echo "//////////////////////////////////////////////////////////////////////////////////////////////////////////"
echo "STATE_4 some settings"
echo "//////////////////////////////////////////////////////////////////////////////////////////////////////////"
echo "//////////////////////////////////////////////////////////////////////////////////////////////////////////"
echo 'XKBOPTIONS="ctrl:nocaps"' |sudo tee -a /etc/default/keyboard > /dev/null
